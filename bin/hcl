#!/usr/bin/env node

var hcl = require('../lib/parser.js');
var compile = require('../lib/compile.js');
var file2js = require('../lib/file2js.js');
var repl = require('repl');

if (process.argv[2]) {
  file2js(process.argv[2]);
} else {
  repl.start({
	prompt: "hcl> ",
	eval: function(cmd, context, filename, callback) {
      try {
		var ast = hcl.analyze(hcl.parse(hcl.scan(cmd.toString())));
		var res = eval(compile(ast[0][0]).replace(/;$/, ''));
		callback(null, res);
      } catch(e) {
		callback(null, e);
      }
	}
  });
}

